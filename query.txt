SELECT A, B AND C FROM TABLE ONE O JOINED WITH TABLE TWO T ON O.A = T.A AND THEN SELECT A, C, D AND SUM(D) FROM T WHERE T.C < 4 GROUP BY O.A